import time

try:
    import ZmqTransport as zt
except ImportError:
    print('Cannot import ZmqTransport! Ensure ZmqTransport.pyd and libzmq.dll are accessable.')
    exit(-1)

paramNames = [
"2_CC0101", "2_CC0102", "2_CC0111", "2_CC0110", "2_CC0209", "2_CC0202", "2_CC0201", "2_CC0104",
"2_CC0105", "2_CC0103", "2_CC0108", "2_CC0106", "2_CC0109", "2_CC0204", "2_CC0212", "2_CC0213",
"2_CC0211", "2_CC0210", "2_CC0205", "2_CC0206", "2_CC0208", "2_CC0207", "2_CC0203", "2_CC0112",
"1_CC1801", "1_CC1802", "1_CC1803", "1_CC1804", "1_CC1805", "1_CC1806", "1_CC1807", "1_CC1808",
"1_CC1809", "1_CC1810", "1_CC1811", "1_CC1812", "1_CC1813", "1_CC1814", "1_CC1815", "1_CC1816",
"1_CC1817", "1_CC1818", "1_CC1819", "1_CC1820", "1_CC1821", "1_CC1822", "1_CC1823", "1_CC1824",
"1_CC1825", "1_CC1826", "1_CC1827", "1_CC1828", "1_CC1901", "1_CC1902", "1_CC1903", "1_CC1904",
"1_CC1905", "1_CC1906", "1_CC1907", "1_CC1908", "1_CC2001", "1_CC2002", "1_CC2003", "1_CC2004", 
"1_CC2005", "1_CC2006", "1_CC2007", "1_CC2008", "1_CC2009", "1_CC2010", "1_CC2011", "1_CC2012",
"1_CC2101", "1_CC2201", "1_CC2301", "1_CC1201", "1_CC1202", "1_CC1203", "1_CC1204", "1_CC1205",
"1_CC1206", "1_CC1207", "1_CC1208", "1_CC1209", "1_CC1210", "1_CC1211", "1_CC1212", "1_CC1213",
"1_CC1214", "1_CC1215", "1_CC1216", "1_CC1217", "1_CC1218", "1_CC1219", "1_CC1220", "1_CC1221",
"1_CC1222", "1_CC1301", "1_CC1302", "1_CC1303", "1_CC1304", "1_CC1305", "1_CC1306", "1_CC1307", 
"1_CC1308", "1_CC1309", "1_CC1310", "1_CC1311", "1_CC1312", "1_CC1313", "1_CC1314", "1_CC1315",
"1_CC1316", "1_CC1317", "1_CC1318", "1_CC1319", "1_CC1320", "1_CC1321", "1_CC1322", "1_CC1323",
"1_CC1324", "1_CC1401", "1_CC1402", "1_CC1403", "1_CC1404", "1_CC1405", "1_CC1406", "1_CC1407",
"1_CC1408", "1_CC1409", "1_CC1410", "1_CC1411", "1_CC1412", "1_CC1413", "1_CC1414", "1_CC1415",
"1_CC1416", "1_CC1417", "1_CC1418", "1_CC1419", "1_CC1501", "1_CC1502", "1_CC1503", "1_CC1504",
"1_CC1505", "1_CC1506", "1_CC1507", "1_CC1508", "1_CC1509", "1_CC1510", "1_CC1511", "1_CC1512",
"1_CC1513", "1_CC1514", "1_CC1515", "1_CC1516", "1_CC1517", "1_CC1518", "1_CC1519", "1_CC1520",
"1_CC1601", "1_CC1602", "1_CC1603", "1_CC1604", "1_CC1605", "1_CC1606", "1_CC1607", "1_CC1608",
"1_CC1609", "1_CC1610", "1_CC1611", "1_CC1612", "1_CC1613", "1_CC1614", "1_CC1615", "1_CC1616",
"1_CC1617", "1_CC1618", "1_CC1619", "1_CC1620", "1_CC1621", "1_CC1622", "1_CC1623", "1_CC1624",
"1_CC1625", "1_CC1626", "1_CC1701", "1_CC1702", "1_CC1703", "1_CC1704", "1_CC1705", "1_CC1706",
"1_CC1707", "1_CC1708", "1_CC1709", "1_CC1710", "1_CC1711", "1_CC1712", "1_CC1713", "1_CC1714",
"1_CC1715", "1_CC1716", "1_CC1717", "1_CC1718", "1_CC1719", "1_CC1720", "1_CC1721", "1_CC1722",
"1_CC1723", "1_CC1724", "1_CC1725", "1_CC1726", "1_CC1727", "1_CC0701", "1_CC0702", "1_CC0703",
"1_CC0704", "1_CC0705", "1_CC0706", "1_CC0707", "1_CC0708", "1_CC0709", "1_CC0710", "1_CC0711",
"1_CC0712", "1_CC0713", "1_CC0714", "1_CC0715", "1_CC0716", "1_CC0717", "1_CC0718", "1_CC0719",
"1_CC0720", "1_CC0721", "1_CC0722", "1_CC0801", "1_CC0802", "1_CC0803", "1_CC0804", "1_CC0805",
"1_CC0806", "1_CC0807", "1_CC0808", "1_CC0809", "1_CC0810", "1_CC0811", "1_CC0812", "1_CC0813",
"1_CC0814", "1_CC0815", "1_CC0816", "1_CC0817", "1_CC0818", "1_CC0901", "1_CC0902", "1_CC0903",
"1_CC0904", "1_CC0905", "1_CC0906", "1_CC0907", "1_CC0908", "1_CC0909", "1_CC0910", "1_CC0911",
"1_CC0912", "1_CC0913", "1_CC0914", "1_CC0915", "1_CC0916", "1_CC0917", "1_CC0918", "1_CC0101",
"1_CC0102", "1_CC0103", "1_CC0104", "1_CC0105", "1_CC0106", "1_CC0107", "1_CC0108", "1_CC0109",
"1_CC0110", "1_CC0111", "1_CC0112", "1_CC0113", "1_CC0114", "1_CC0115", "1_CC0116", "1_CC0117",
"1_CC0118", "1_CC0119", "1_CC0120", "1_CC0121", "1_CC0122", "1_CC0123", "1_CC0124", "1_CC0125",
"1_CC0126", "1_CC0127", "1_CC0128", "1_CC0129", "1_CC0301", "1_CC0302", "1_CC0303", "1_CC0304",
"1_CC0305", "1_CC0306", "1_CC0307", "1_CC0308", "1_CC0309", "1_CC0310", "1_CC0311", "1_CC0312",
"1_CC0313", "1_CC0314", "1_CC0315", "1_CC0316", "1_CC0317", "1_CC0318", "1_CC0319", "1_CC0320",
"1_CC0321", "1_CC0401", "1_CC0402", "1_CC0403", "1_CC0404", "1_CC0405", "1_CC0406", "1_CC0407",
"1_CC0408", "1_CC0409", "1_CC0410", "1_CC0411", "1_CC0412", "1_CC0413", "1_CC0414", "1_CC0415",
"1_CC0416", "1_CC0417", "1_CC0418", "1_CC0419", "1_CC0420", "1_CC0501", "1_CC0502", "1_CC0503",
"1_CC0504", "1_CC0505", "1_CC0506", "1_CC0507", "1_CC0508", "1_CC0509", "1_CC0510", "1_CC0511",
"1_CC0512", "1_CC0513", "1_CC0514", "1_CC0515", "1_CC0201", "1_CC0202", "1_CC0203", "1_CC0601",
"1_CC0602", "1_CC0603", "1_CC0604", "1_CC0605", "1_CC0606", "1_CC0607", "1_CC0608", "1_CC0609",
"1_CC0610", "1_CC0611", "1_CC0612", "1_CC0613", "1_CC0614", "1_CC0615", "1_CC0616", "1_CC0617",
"1_CC0618", "1_CC0619", "1_CC0620", "1_CC0621", "1_CC0622", "1_CC0623", "1_CC0624", "1_CC0625",
"1_CC0626", "1_CC0627", "1_CC0628", "1_CC0629", "1_CC0630", "1_CC0631", "1_CC0632"]

data = '{ "idList": [';
for name in paramNames:
    data += '"' + name + '", '
data = data[:-2] + '] }'
msg = zt.Message("", 1, data)

def onMsg(msg):
    if msg.messageType != -1:
        print(msg)

client = zt.CreateZmqClient()
receiver = zt.IMessageReceiver.Create(onMsg)
client.SubscribeMessageRaw(receiver)
client.Connect("tcp", "127.0.0.1", 3333, 7777)

client.Send(msg)

while True:
    time.sleep(0.1)

client.Shutdown()

